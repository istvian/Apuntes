# SCRIPT 1

## Ejecutar script

```sql
create table equipamiento(
codEquip varchar2(5) not null primary key,
descripEquip varchar2(30),
marcaEquip varchar2(20),
modeloEquip varchar2(14)
);
create table persona(
rutPer varchar2(13) not null primary key,
nomPer varchar2(20),
apPatPer varchar2(15),
apMatPer varchar2(15),
fonoPer varchar2(14)
);
create table ventaequip(
codVenta number(4) not null primary key,
fechaVenta date,
costoVenta number(6),
codEq varchar2(5) not null references equipamiento,   -- codEq es varchar2 igual que codEquip
rutPersona varchar2(13) not null references persona   -- rutPersona es varchar2 igual que rutPer
);

insert into equipamiento values('MTY67','Taladro','Makita','TD70');
insert into equipamiento values('SRF54','Motosierra','Stihl','ST67');
insert into equipamiento values('BRF56','Cepilladora','Bosch','BD56');
insert into equipamiento values('MGR67','Martillo','Makita','MT56');
insert into equipamiento values('STY54','Serrucho','Stihl','ST56');
insert into equipamiento values('SRF57','Galletera','Bosch','RD26');

insert into persona values('10534876-5','David','Parra','Lara','945219992');
insert into persona values('14340300-k','Marta','Vidal','Vera','979050234');
insert into persona values('12500320-8','Daniel','Mena','Duarte','994568001');
insert into persona values('8768320-1','Carla','Villa','Jara','');
insert into persona values('9435678-9','Gabriel','Castro','Godoy','');
insert into persona values('14567980-k','Francisca','Barra','Méndez','987658908');

insert into ventaequip values(2354,'5/4/2023',23000,'MTY67','10534876-5');
insert into ventaequip values(2365,'23/4/2023',87000,'SRF54','10534876-5');
insert into ventaequip values(2378,'11/5/2023',59000,'MTY67','14340300-k');
insert into ventaequip values(2388,'23/5/2023',45000,'SRF54','14567980-k');
insert into ventaequip values(2376,'26/5/2023',59000,'STY54','9435678-9');
insert into ventaequip values(2413,'12/6/2023',28900,'MGR67','8768320-1');
insert into ventaequip values(2425,'30/6/2023',35000,'STY54','14567980-k');
insert into ventaequip values(2436,'5/7/2023',67500,'SRF54','9435678-9');
insert into ventaequip values(2457,'23/7/2023',97600,'MGR67','10534876-5');
insert into ventaequip values(2464,'26/7/2023',88700,'MTY67','8768320-1');

```

> [!TIP]
> Para crear una PRIMARY KEY utilizar: codVenta number(4) not null primary key,

> [!TIP]
> Para crear un FOREIGN KEY utilizar: rutPersona varchar2(13) not null references persona

![image](https://github.com/user-attachments/assets/73471b03-66da-4a4a-a9d2-22149c6f0021)

## Eliminar un registro (DELETE)

```sql
DELETE FROM ventaequip WHERE codventa=2378;
SELECT * FROM ventaequip;

DELETE FROM VENTAEQUIP WHERE CODVENTA = 2457;
SELECT * FROM VENTAEQUIP;


```

## Errores al eliminar un registro
No se puede eliminar ese registro, ya que ese código tiene una foránea asociada en la tabla ventaequip, o sea, se mantiene la integridad referencial.

> [!WARNING]
> El código tira error porque se eliminaría un elemento que se esta utilizando en la tabla VentaEquip

```SQL
DELETE FROM EQUIPAMIENTO WHERE CODEQUIP='MGR67';
SELECT * FROM EQUIPAMIENTO;
SELECT * FROM VENTAEQUIP;
---ORA-02292: integrity constraint (SYSTEM.SYS_C007037) violated - child record found
```
```SQL
DELETE FROM PERSONA WHERE RUTPER='14567980-k'
--- ORA-02292: integrity constraint (SYSTEM.SYS_C007038) violated - child record found

```


> [!CAUTION]
> Si se llega a ejecutar sólo: 'DELETE FROM TABLE' deja vacia la tabla. Se pueden perder datos, siempre hay que colocar una condición WHERE.

```SQL
DELETE FROM VENTAEQUIP;
--- 8 filas eliminado
-- Tabla vacía
```

## Condiciones de DELETE

### Operadores

```sql
> 
<
>=
<=
<> --- DISTINTO
AND
OR
```

### Ejemplo

```SQL
DELETE FROM VENTAEQUIP WHERE COSTOVENTA >50000;
--- 6 FILAS ELIMINADAS

DELETE FROM VENTAEQUIP WHERE FECHAVENTA >='15/5/2023' AND FECHAVENTA <='10/7/2023';
--- 3 FILAS ELIMINADAS

DELETE FROM VENTAEQUIP WHERE COSTOVENTA <>40000;
--- 1 FILA ELIMINADA
--- TABLA VACIA
```

## TRUNCATE
Deja vacía la tabla. Se utiliza en tablas temporales o cuando uno realiza pruebas.

```SQL
TRUNCATE TABLE VENTAEQUIP;
--- TABLE VENTAEQUIP TRUNCADO. (ESTA VACÍA)
```

> [!TIP]
> Si intento hacer TRUNCATE a tablas maestras como personas o equipamiento lanza error, porque tiene tablas hijas que dependen de ellas.

---


# SCRIPT 2

