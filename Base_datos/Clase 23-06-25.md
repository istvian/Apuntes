# ORDER BY

Ordena según un campo, va al final de la sentencia y por defecto ordena de forma ascendente.

## Ejemplo:

```sql
SELECT CODVENTA, COSTOVENTA FROM VENTAS ORDER BY COSTOVENTA;
```

Para hacerlo descendente solo se agrega desc al final

```sql
SELECT CODVENTA, COSTOVENTA FROM VENTAS ORDER BY COSTOVENTA DESC;
```

***Puedo ordenar por varios campos a la vez.***

Ejemplo:
Se puede ordenar por marca y modelo a la vez

```sql
SELECT * FROM EQUIPOS ORDER BY MARCAEQUIPO, MODELOEQUIPO;
```

> [!IMPORTANT]
> En base de datos esto muestra los datos ordenados, pero no ordena los datos en la base de datos.


### Ejercicio propuesto

Mostrar ordenadas las personas por apellido paterno y materno a la vez

```sql
SELECT * FROM PERSONAS ORDER BY APPATPER, APMATPER;
```
RESULTADO

![image](https://github.com/user-attachments/assets/91e5c711-336c-487c-8295-dc99a44aa066)

# Funciones grupales
SUM, AVG, MIN, MAX Y COUNT (Suma, promedio, menor, mayor, contar)

---

### SUM
Calcula la suma de los valores de un campo

```sql
SELECT SUM(COSTOVENTA) FROM VENTAS;
```

### AVG
Promediar los costos pagados en ventas

```sql
SELECT AVG(COSTOVENTA) Promedio_de_ventas --  ESTO ES UN ALIAS
FROM VENTAS;
```

> [!NOTE]
> Un alias reemplaza el nombre por defecto. No puede llevar espacios

```sql
SELECT ROUND(AVG(COSTOVENTA),2) Promedio_de_ventas --  ESTO ES UN ALIAS
FROM VENTAS;
```

> [!TIP]
> El Round redondea a la cantidad de decimales indicada, cuando se utiliza promedio, es muy importante usarlo

### MIN
Muestra el menor valor del campo

Ejemplo: Obtener el menor costo de venta

```sql
SELECT MIN(COSTOVENTA) MÍNIMO
FROM VENTAS;
```

Cuando se necesita la fecha de venta más antigua (la primera), usar:

```sql
SELECT MIN(FECHAVENTA)
FROM VENTAS;
```

### MAX
Es lo contrario a MIN, muestra el mayor
En las fechas muestra la fecha más reciente (la última)

```sql
SELECT MAX(FECHAVENTA)
FROM VENTAS;
```

### COUNT
Calcula la cantidad de valores de un campo, "los cuenta"

Ejemplo: Contar los telefonos de las personas

```sql
SELECT COUNT(FONOPER)
FROM PERSONAS;
```

> [!TIP]
> Para contar todos los registros de una tabla, por ejemplo, para la tabla personas, se escribe: COUNT(*)

```SQL
SELECT COUNT(*)
FROM PERSONAS;
```

## Ejercicio propuesto

1) Mostrar rut de personas a quienes se ha vendido el equipo con código DRF54

```SQL
SELECT RUTPERSONA FROM VENTAS WHERE CODEQUIPO ='DRF54';
```

2) VISUALIZAR CODIGOS DE EQUIPOS VENDIDOS ENTRE EL 1 DE MAYO DEL 2023 AL 4 DE JULIO DEL 2023

```SQL
-- UTILIZANDO UN WHERE AND
SELECT CODEQUIPO FROM VENTAS WHERE FECHAVENTA >='01/05/2023' AND FECHAVENTA <='04/07/2023';

-- UTILIZANDO UN BETWEEN
SELECT CODEQUIPO FROM VENTAS WHERE FECHAVENTA BETWEEN '01/05/2023' AND '4/7/2023';
```

3) MOSTRAR NOMBRE COMPLETO DE PERSONAS CUYOS RUT EMPIEZAN CON 14

```SQL
SELECT NOMPER, APPATPER, APMATPER FROM PERSONAS WHERE RUTPER LIKE '14%';
```

4) MOSTRAR FECHAS DE VENTA DE EQUIPOS CON CODIGO RTY67 Y CON COSTO DE VENTA MENOR A 40000

```SQL
SELECT FECHAVENTA FROM VENTAS WHERE CODEQUIPO = 'RTY67' AND COSTOVENTA <40000;
```

5) MOSTRAR LA SUMA DE COSTOS DE VENTA PARA EL EQUIPO CON CODIGO DRF54

```sql
SELECT SUM(COSTOVENTA)Suma_total
FROM VENTAS WHERE CODEQUIPO ='DRF54';
```

6) MOSTRAR EL PROMEDIO DE TODAS LAS VENTAS

```SQL
SELECT ROUND(AVG(COSTOVENTA),2) Promedio FROM VENTAS;
```

7) MOSTRAR LA FECHA DE LA PRIMERA VENTA DE JUNIO 2023

```SQL
SELECT MIN(FECHAVENTA) Primera_venta_junio
FROM VENTAS WHERE FECHAVENTA BETWEEN '01/06/2023' AND '30/06/2023';
```

# EJERCICIO PRACTICA CERTAMEN

1)	Crear estas 4 tablas.
2)	Insertar 4 clientes, 10 facturas,6 herramientas y 20 arriendos.
3)	Eliminar una factura, según un criterio definido por Ud.
4)	Modificar una fecha de arriendo.
5)	Modificar todos los montos finales aumentándolos en un 19%.
6)	Agregar el campo ciudad a la tabla Cliente.
7)	Modificar las ciudades de cada cliente por las que Ud. elija.
Usando Select, mostrar:
8)	El número de factura, fecha y monto final anteriores a una cierta fecha.
9)	La fecha del primer arriendo.
10)	Los números de arriendo y rut de cliente, en un rango de número de arriendo.
11)	El promedio de costos de arriendos.
12)	Los números de factura y montos finales en un rango de monto final, ordenado por monto final.
13)	Los nombres de clientes que empiezan con alguna letra.
14)	Los números de arriendo con fechas terminadas en 23.
15)	El mayor costo de arriendo.
16)	El número de arriendo, la fecha y costo, para una fecha mayor a una indicada y a un costo menor a uno indicado.
17)	El nombre del cliente y ciudad, para una ciudad u otra indicadas.
18)	Sin repetir, los códigos de herramientas arrendadas.
19)	.
20)	.

```SQL
-- 1) CREAR 4 TABLAS

CREATE TABLE CLIENTE(
RUTCLIENTE VARCHAR2(10) NOT NULL PRIMARY KEY,
NOMBRE VARCHAR2(20),
TELEFONO VARCHAR2(10)
);

CREATE TABLE HERRAMIENTAS(
CODIGOHERR NUMBER(10) NOT NULL PRIMARY KEY,
NOMBRE VARCHAR2(20),
PRECIODIARIO NUMBER(10)
);

CREATE TABLE FACTURA(
NUMFACTURA NUMBER(10) NOT NULL PRIMARY KEY,
FECHA DATE,
MONTOFINAL NUMBER(10),
RUTCLIENTE VARCHAR2(10) NOT NULL REFERENCES CLIENTE
);

CREATE TABLE ARRIENDO(
NUMARRIENDO NUMBER(10) NOT NULL PRIMARY KEY,
RUTCLIENTE VARCHAR2(10) NOT NULL REFERENCES CLIENTE,
CODIGOHERR NUMBER(10) NOT NULL REFERENCES HERRAMIENTAS,
FECHAARR DATE,
COSTOARR NUMBER(10)
);

-- 2) INSERTAR 4 CLIENTES, 10 FACTURAS, 6 HERRAMIENTAS Y 20 ARRIENDOS

INSERT INTO CLIENTE VALUES ('20678999-1', 'PEDRO', '911104583'); 
INSERT INTO CLIENTE VALUES ('19678888-2', 'FERNANDO', '922204584'); 
INSERT INTO CLIENTE VALUES ('17678777-3', 'SIMON', '933304588'); 
INSERT INTO CLIENTE VALUES ('18672666-4', 'TERESA', '944404587'); 

INSERT INTO FACTURA VALUES (1, '01/01/2023', '280000','20678999-1'); 
INSERT INTO FACTURA VALUES (2, '20/02/2023', '380000','19678888-2'); 
INSERT INTO FACTURA VALUES (3, '12/03/2023', '480000','20678999-1'); 
INSERT INTO FACTURA VALUES (4, '13/04/2023', '580000','17678777-3'); 
INSERT INTO FACTURA VALUES (5, '14/05/2023', '680000','20678999-1'); 
INSERT INTO FACTURA VALUES (6, '27/04/2023', '780000','19678888-2'); 
INSERT INTO FACTURA VALUES (7, '30/06/2023', '1080000','18672666-4'); 
INSERT INTO FACTURA VALUES (8, '02/02/2023', '880000','19678888-2'); 
INSERT INTO FACTURA VALUES (9, '10/03/2023', '980000','17678777-3'); 
INSERT INTO FACTURA VALUES (10, '29/10/2023', '180000','18672666-4'); 
  
INSERT INTO HERRAMIENTAS VALUES (12,'MARTILLO','15000'); 
INSERT INTO HERRAMIENTAS VALUES (35,'SERRUCHO','20000'); 
INSERT INTO HERRAMIENTAS VALUES (23,'MOTOSIERRA','500000'); 
INSERT INTO HERRAMIENTAS VALUES (44,'LLAVE INGELSA','12000'); 
INSERT INTO HERRAMIENTAS VALUES (18,'ALICATE','5000'); 
INSERT INTO HERRAMIENTAS VALUES (11,'SOPLETE','10000'); 

INSERT INTO ARRIENDO VALUES (280,'20678999-1',23,'06/05/2023','29000'); 
INSERT INTO ARRIENDO VALUES (222,'19678888-2',35,'05/06/2023','39000'); 
INSERT INTO ARRIENDO VALUES (232,'17678777-3',12,'10/07/2023','68000'); 
INSERT INTO ARRIENDO VALUES (213,'19678888-2',44,'17/08/2023','40000'); 
INSERT INTO ARRIENDO VALUES (256,'17678777-3',18,'23/09/2023','15000'); 
INSERT INTO ARRIENDO VALUES (290,'20678999-1',11,'24/10/2023','34000'); 
INSERT INTO ARRIENDO VALUES (200,'19678888-2',23,'02/11/2023','29000'); 
INSERT INTO ARRIENDO VALUES (221,'17678777-3',12,'10/12/2023','68000'); 
INSERT INTO ARRIENDO VALUES (278,'20678999-1',44,'02/01/2024','40000'); 
INSERT INTO ARRIENDO VALUES (281,'19678888-2',35,'30/02/2024','39000'); 
INSERT INTO ARRIENDO VALUES (251,'18672666-4',11,'11/03/2024','34000'); 
INSERT INTO ARRIENDO VALUES (250,'19678888-2',18,'09/03/2024','15000'); 
INSERT INTO ARRIENDO VALUES (260,'17678777-3',35,'03/04/2024','39000'); 
INSERT INTO ARRIENDO VALUES (310,'19678888-2',23,'15/05/2024','29000'); 
INSERT INTO ARRIENDO VALUES (320,'20678999-1',11,'17/06/2024','34000'); 
INSERT INTO ARRIENDO VALUES (420,'18672666-4',12,'19/06/2024','68000'); 
INSERT INTO ARRIENDO VALUES (100,'19678888-2',23,'22/07/2024','29000'); 
INSERT INTO ARRIENDO VALUES (340,'20678999-1',23,'15/08/2024','29000'); 
INSERT INTO ARRIENDO VALUES (780,'18672666-4',35,'20/08/2024','39000'); 

-- 3) ELIMINAR UNA FACTURA, SEGUN UN CRITERIO DEFINIDO POR UD.

DELETE FROM FACTURA WHERE NUMFACTURA =4;
--SELECT * FROM FACTURA;

-- 4) MODIFICAR UNA FECHA DE ARRIENDO

UPDATE ARRIENDO
SET FECHAARR ='23/06/2025'
WHERE NUMARRIENDO = 222;
--SELECT * FROM ARRIENDO;

-- 5) MODIFICAR TODOS LOS MONTOS FINALES AUMENTANDOLOS EN UN 19%

UPDATE FACTURA
SET MONTOFINAL = MONTOFINAL *1.19;
--SELECT * FROM FACTURA;

-- 6) AGREGAR EL CAMPO CIUDAD A LA TABLA CLIENTE

ALTER TABLE CLIENTE ADD CIUDAD VARCHAR2(20);
--DESCRIBE CLIENTE;

-- 7) MODIFICAR LAS CIUDADES DE CADA CLIENTE POR LAS QUE UD. ELIJA

UPDATE CLIENTE
SET CIUDAD = 'TALCAHUANO'
WHERE NOMBRE ='PEDRO';

UPDATE CLIENTE
SET CIUDAD = 'CONCEPCION'
WHERE NOMBRE ='FERNANDO';

UPDATE CLIENTE
SET CIUDAD = 'HUALPEN'
WHERE NOMBRE ='SIMON';

UPDATE CLIENTE
SET CIUDAD = 'SANTIAGO'
WHERE NOMBRE ='TERESA';

--SELECT * FROM CLIENTE;

-- 8) EL NUMERO DE FACTURA, FECHA Y MONTO FINAL ANTERIORES A UNA CIERTA FECHA

SELECT NUMFACTURA, FECHA, MONTOFINAL FROM FACTURA WHERE FECHA < '27/04/2023';
--SELECT * FROM FACTURA;

-- 9) LA FECHA DEL PRIMER ARRIENDO

SELECT MIN(FECHAARR) FROM ARRIENDO;

-- 10) LOS NUMEROS DE ARRIENDO Y RUT DE CLIENTE, EN UN RANGO DE NUMERO DE ARRIENDO

SELECT NUMARRIENDO, RUTCLIENTE FROM ARRIENDO WHERE NUMARRIENDO BETWEEN 200 AND 250;

--11 ) EL PROMEDIO DE COSTOS DE ARRIENDOS

SELECT ROUND(AVG(COSTOARR),2) Promedio FROM ARRIENDO;

-- 12) LOS NUMEROS DE FACTURA Y MONTOS FINALES EN UN RANGO DE MONTO FINAL, ORDENADO POR MONTO FINAL

SELECT NUMFACTURA, MONTOFINAL FROM FACTURA WHERE MONTOFINAL BETWEEN 500000 AND 700000 ORDER BY MONTOFINAL;

-- 13) LOS NOMBRES DE CLIENTES QUE EMPIEZAN CON ALGUNA LETRA

SELECT NOMBRE FROM CLIENTE WHERE NOMBRE LIKE 'S%';

-- 14) LOS NUMEROS DE ARRIENDO CON FECHAS TERMINADAS EN 23

SELECT NUMARRIENDO FROM ARRIENDO WHERE FECHAARR LIKE '%/%/23';
--SELECT * FROM ARRIENDO;

-- 15)EL MAYOR COSTO DE ARRIENDO

SELECT MAX(COSTOARR) FROM ARRIENDO;

-- 16) EL NUMERO DE ARRIENDO, LA FECHA Y COSTO, PARA UNA FECHA MAYOR A UNA INDICADA Y A UN COSTO MENOR A UNO INDICADO.

SELECT NUMARRIENDO, FECHAARR, COSTOARR FROM ARRIENDO WHERE FECHAARR > '01/01/2024' AND COSTOARR <30000;

-- 17) EL NOMBRE DEL CLIENTE Y CIUDAD, PARA UNA CIUDAD U OTRA INDICADAS

SELECT NOMBRE, CIUDAD FROM CLIENTE WHERE CIUDAD ='TALCAHUANO' OR CIUDAD ='SANTIAGO';
SELECT NOMBRE, CIUDAD FROM CLIENTE WHERE CIUDAD IN ('TALCAHUANO','SANTIAGO', 'HUALPEN');

-- 18) SIN REPETIR, LOS CODIGOS DE HERRAMIENTAS ARRENDADAS

SELECT DISTINCT CODIGOHERR FROM HERRAMIENTAS;

-- 19) De la tabla Arriendo el rut de cliente y costos, para costos mayores a uno indicado por Ud. y ordenado por costo.

SELECT RUTCLIENTE, COSTOARR FROM ARRIENDO WHERE COSTOARR >20000 ORDER BY COSTOARR;

-- 20) De la tabla Factura, los rut de clientes y montos, para montos menores a uno indicado por Ud. y ordenado por montos.

-- SELECT * FROM FACTURA;
SELECT RUTCLIENTE, MONTOFINAL FROM FACTURA WHERE MONTOFINAL < 1000000 ORDER BY MONTOFINAL;

```
