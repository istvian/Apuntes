# Manejo de los datos requeridos por HTTP (deserializar)

```python
# import json
import requests
from Database2 import *

# respuesta = requests.get("https://api.gael.cloud/general/public/sismos")
respuesta = requests.get("http://localhost/ej1/conecta.php")


class Ventas:
    def __init__(self, fact1, fecha1, rut1, valor1):
        self.fact = fact1
        self.fecha = fecha1
        self.rut = rut1
        self.valor = valor1

    def insertar(self, numF, fechaF, rutC, valorF):
        sql1 = "select numerofactura from ventapython where numerofactura=" + repr(numF)
        try:
            db.cursor.execute(sql1)
            if db.cursor.fetchone() == None:  # valida que el número de fact. no exista
                sql2 = (
                    "insert into ventapython values("
                    + repr(numF)
                    + ","
                    + repr(fechaF)
                    + ","
                    + repr(rutC)
                    + ","
                    + repr(valorF)
                    + ")"
                )
                try:
                    db.cursor.execute(sql2)
                    db.conexion.commit()
                except Exception as err:
                    db.conexion.rollback()
                    print(err)
            else:
                print("Ya existe ese número de factura")
        except Exception as err:
            print(err)


lista = []
db = Database2()

for v in respuesta.json():
    lista.append(Ventas(v["numfact"], v["fechafact"], v["rutcli"], v["monto"]))
    # llena el objeto lista con los datos desearializados
print("{:10}{:12}{:12}{:>11}".format("Factura", "Fecha", "Rut Cli", "Valor Fact."))
for x in lista:
    print("{:10}{:12}{:12}{:>11}".format(x.fact, x.fecha, x.rut, x.valor))
    x.insertar(x.fact, x.fecha, x.rut, x.valor)


```

```python
import pymysql  #antes pip install pymysql
class Database:
    def __init__(self):
        self.conexion=pymysql.connect(
            host='localhost',
            user='root',
            password='12345678',
            database='empresa'
        )
        self.cursor=self.conexion.cursor()
```

```sql
create table ventapython(
numerofactura int primary key,
fechaventa date,
rutcliente varchar(10),
valorfact float
)engine=innodb;
```
