# MYSQL

```sql
create table Repuestos(
codRep varchar(3) not null primary key,
nomRep varchar(20),
fechaFabr date,
precioProveedor int(8),
precioVenta int(8),
peso decimal(6,2)
) engine=innodb;

insert into Repuestos values('r23','Motor tipo A1','2023/5/12',250000,270000,93.56);
insert into Repuestos values('r26','Motor tipo B1','2021/6/14',280000,310000,113.49);
insert into Repuestos values('r27','Motor tipo C3','2023/5/3',220000,250000,87.23);
insert into Repuestos values('r43','Inyector angu','2022/3/5',190000,185000,2.56);
insert into Repuestos values('r46','Inyector basal','2020/5/8',134000,140000,3.79);
insert into Repuestos values('r80','Válvula centry','2023/4/28',195000,230000,0.28);
insert into Repuestos values('r84','Válvula zenner','2022/5/21',265000,300000,0.72);

create table Ventas(
numVenta int(10) not null primary key,
codRepuesto varchar(3) not null references repuestos(codRep),
fechaVenta date,
montoVenta int(8)
)engine=innodb;

insert into ventas values(2500,'r26','2023/8/20',900000);
insert into ventas values(2501,'r43','2023/8/24',725000);
insert into ventas values(2502,'r27','2023/9/3',922000);
insert into ventas values(2503,'r84','2023/9/5',890000);

```

> [!NOTE]
> Las fechas se escriben AAAA/MM/DD
> Se declara motor para tablas relacionales engine=innodb;
> varchar en vez de varchar2
> int => entero
> decimal => decimales
> date => fechas

Instalar la biblioteca de conexión a MYSQL
```terminal
pip install pymysql
```

Crear 2 archivos

=> Database.py
=> Conecta.py

Database.py
```python
import pymysql


class Database:
    def __init__(self):
        self.conexion = pymysql.connect(
            host="localhost", user="root", password="12345678", database="empresa"
        )
        self.cursor = self.conexion.cursor()

    def cerrarDB(self):
        self.cursor.close()
        self.conexion.close()

    def select_todos(self):
        sql = "SELECT * FROM REPUESTOS"
        try:
            self.cursor.execute(sql)
            repu = self.cursor.fetchall()
            print(
                f"{'Codigo':10}{'Nombre rep.':20}{'Fecha fabr.':12}\
                  {'Precio prov.':12}{'Precio ven.':12}{'Peso':12}"
            )
            for rep in repu:
                print(
                    f"{rep[0]:10}{rep[1]:20}{rep[2].strftime('%d/%m/%Y'):12}\
                      {rep[3]:<12}{rep[4]:<12}{rep[5]:<12}"
                )
                # print(rep)
        except Exception as err:
            print(err)

```

Conecta.py
```python
from Database import *

db = Database()
db.select_todos()
db.cerrarDB()

```
