# Indices

La busqueda siempre es secuencial, pero si hay un indice va directo al resultado.

Los indices se ocupan cuando hay una gran cantidad de registros (miles o más)

```SQL
create table transporte(
patente varchar2(6) not null primary key,
marca varchar2(20),
modelo varchar2(20),
color varchar2(15)
);
create table encomienda(
codEnc number(8) not null primary key,
peso number(5),  --en gr
costo number(6),
fecha date,
patenteTransp varchar2(6) not null references transporte
);
insert into transporte values('CTFT45','Ford','Cargo','Blanco');
insert into transporte values('DFGR35','Mercedes Benz','Zetros','Negro');
insert into transporte values('DRTQ87','Renault','Maxity','Blanco');
insert into encomienda values(1,2380,12000,'13/10/2023','CTFT45');
insert into encomienda values(2,1450,35000,'22/10/2023','DFGR35');
insert into encomienda values(3,2130,23000,'25/10/2023','CTFT45');
insert into encomienda values(4,1569,30000,'25/10/2023','DRTQ87');
insert into encomienda values(5,2176,15000,'26/10/2023','DFGR35');
```

Usando el Diccionario de Datos, para ver que indices hay en una tabla, se escribe:

```SQL
SELECT INDEX_NAME FROM ALL_INDEXES WHERE TABLE_NAME='ENCOMIENDA';
```

<img width="286" height="103" alt="image" src="https://github.com/user-attachments/assets/70011e5b-a885-4502-ba66-6d3d1ffe4846" />

A veces se hace necesario crear un índice, para buscar datos que no son la clave primaria, por ejemplo, si se necesitan hacer muchas consultas según la fecha de las encomiendas, entonces se debe crear un índice apuntando a la fecha.


on => Apuntar ahi, sobre esa tabla

```sql
CREATE INDEX INDICE_FECHA ON ENCOMIENDA(FECHA);
```

<img width="353" height="143" alt="image" src="https://github.com/user-attachments/assets/93b33769-af95-4765-8bba-4b99e4b11552" />

Si es que surge la necesidad de buscar por fecha... se utiliza un indice para que sea más rapido

Se puede monitorear si el índice ha sido usado o no. Esto consiste en ejecutar la siguiente instrucción

```sql
-- HABILITAR MONITOREO DE INDICE FECHA
ALTER INDEX INDICE_FECHA MONITORING USAGE;

-- CONSULTAR SI EL INDICE HA SIDO USADO
SELECT * FROM V$OBJECT_USAGE WHERE TABLE_NAME = 'ENCOMIENDA';

-- CONSULTAR POR FECHA
SELECT FECHA FROM ENCOMIENDA WHERE FECHA<'25/10/2023';

-- EJECUTAR NUEVAMENTE SI EL INDICE HA SIDO USADO
SELECT * FROM V$OBJECT_USAGE WHERE TABLE_NAME = 'ENCOMIENDA';

-- PARA DEJAR DE MONITOREAR EL INDICE SE EJECUTA LA SIGUIENTE INSTRUCCION:
ALTER INDEX INDICE_FECHA NOMONITORING USAGE;

```

<img width="590" height="83" alt="image" src="https://github.com/user-attachments/assets/1132b523-cfb6-4a35-9811-2a397973e6a0" />
